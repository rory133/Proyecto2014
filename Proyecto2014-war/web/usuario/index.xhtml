<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <f:view locale="#{localeBean.locale}">
        <h:head>
          <f:loadBundle basename="resources.mensajes.mensajes" var="msg"/>
            
            <f:facet name="Principal">
                <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
              <!--  <title>Pagina Principal Usuario</title>-->
            </f:facet>
         <title><h:outputText value="#{msg.app_title_inicio}"/> </title>
         <h:outputStylesheet library="css" name="default.css"  />
         <h:outputStylesheet library="css" name="cssLayout.css"  />
         
<link rel="shortcut icon" type="image/x-icon" href="#{resource['images/favicon.ico']}"/>
         
         
        </h:head>

   <h:body style="background-color: #7092be; background: #7092be !important;" >
             

    <p:layout fullPage="true" rendered="#{ROLE_SOCIO}">
       
        <p:layoutUnit position="north" size="100" resizable="true" closable="true" collapsible="true"
                      style="background-color: #7092be; background: #7092be !important;">
            
            <div class="fondo-norte">
                <div class="texto-norte">
                    <h:form>  
                     <h:outputText value="#{msg['app.Socio']}: #{sessionScope.login.login}  " /> 
                     <h:outputText value="#{msg['app.VotosNegativos']}: #{sessionScope.usuario.votosNegativos}  " />         
                                            
                     <p:commandLink id="salir"  actionListener="#{loginBean.logout()}">
                            <h:outputText value="#{msg['app.Salir']}" />
                             <p:tooltip id="toolTipFade00" for="salir" value="#{msg['app.toolTipSalirComoUsuario']}" />
                        </p:commandLink>
                   
                      
                        </h:form>
                </div>

            

            <h:form id="tabla1" rendered="#{productoView.soloMios}">

                <table border="0" width="100%" id="tabla1"  >

                <tr cellpadding="0" style="height:5px" >
 
                    <td>
                        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5" id="filtraMisProductos">
                                   
                            <p:selectOneRadio id="filtroMisProductos" value="#{productoView.filtroMisProductos}">
                                        <f:selectItem itemLabel="#{msg['app.Ofertados']}" itemValue="ofertados" />
                                        <f:selectItem itemLabel="#{msg['app.Comprados']}" itemValue="comprados" />
                                        <f:selectItem itemLabel="#{msg['app.Vendidos']}" itemValue="vendidos" />
                                        <f:ajax event="valueChange"  render=":form6:form5 @all"/>
                             </p:selectOneRadio>
                         <p:tooltip id="toolTipFade11" for="filtraMisProductos" value="#{msg['app.toolTipFiltraTusProductos']}" />                           
                     </h:panelGrid>
                </td>
                <td>
               
                
                <h:link outcome="crearProducto" id="crearNuevo" >
                        <h:graphicImage library="images" name="nuevo.gif" />
                        <p:tooltip id="toolTipFade02" for="crearNuevo" value="#{msg['app.toolTipCrearUnNuevoProducto']}" />
                </h:link>
                
                </td>
                
                    <td>             
                    
               <h:form>
                   <h:panelGrid id="aGestionarMisProductos3" columns="2" style="margin-bottom:10px" cellpadding="5">
                      <h:outputText value="#{msg['app.GestionarMisProductos']}:" id="botoncillo"/>
                      <p:selectBooleanCheckbox value="#{productoView.soloMios}">

                         <f:ajax event="change" render=":form6 @all"/>
                        <p:tooltip id="toolTipFade2" for="aGestionarMisProductos3" value="#{msg['app.SalirDeGestionarTusProductos']}" />
                      </p:selectBooleanCheckbox>
                  </h:panelGrid>
               </h:form>
                 </td>
                </tr>
            </table>
             </h:form>
            
            <h:form id="tabla2" rendered="#{not productoView.soloMios}">
                  <p:growl id="growl1" />
                <!--
                    <p:growl id="msgs1" showDetail="true" escape="false"/>
                 --> 
                  <table border="0" width="100%" id="tabla2" rendered="#{productoView.soloMios}">
                <tr>
                    <td>
                    <!-- 
                        <p:commandButton id="boton0" value="Aplicar Filtros"   action="#{productoView.todosProductos()}" icon="ui-icon-check" >
                          <f:ajax event="click" render=":form2" />
                          <f:ajax event="click" render=":form2:productos" />
                          <f:ajax event="click" render=":form2:productos:cantidad" />
                        </p:commandButton>
                
                  
                          <p:commandLink action="#{productoView.todosProductos()}">
                                    <f:ajax event="click" render=":form2" />
                                    <f:ajax event="click" render=":form2:productos" />
                                    <f:ajax event="click" render=":form2:productos:cantidad" />
                            <h:outputText value="aplicar filtro" />
                        </p:commandLink>             
                     -->
                    </td>  
                    <td>
                        
                                <h:panelGrid id="panelGrid1" columns="2" style="margin-bottom:10px" cellpadding="5">
                                   
                                    <p:selectOneRadio id="filtro" value="#{productoView.filtro}">
                                        <f:selectItem itemLabel="#{msg['app.itemTodos']}" itemValue="todos" />
                                        <f:selectItem itemLabel="#{msg['app.itemVentaDirecta']}" itemValue="ventaDirecta" />
                                        <f:selectItem itemLabel="#{msg['app.itemSubasta']}" itemValue="subasta" />
                                           <f:ajax event="valueChange"  render=":form2 @all"/>
                                            <f:ajax event="valueChange" render=":form2:productos" />
                                            <f:ajax event="valueChange" render=":form2:productos:cantidad" />
                                           
                                            
                                    </p:selectOneRadio>
                                    <p:tooltip id="toolTipFade11" for="panelGrid1" value="#{msg['app.tooltipFiltrarProductos']}" />
                                </h:panelGrid>
                   
                    </td> 
                    <td class='alnright'>
                        
                                    <p:inputText id="nombre" value="#{productoView.nombreBuscado}" label="busqueda">
                                   <p:tooltip id="toolTipFade1" for="nombre" value="#{msg['app.tooltipBuscarPorNombre']}" />
                                    </p:inputText>
                        

                    </td> 
                    <td class='alnleft'>

                        <p:commandLink id="buscaXNombre" update="growl1" action="#{productoView.buscaXNombre()}">
                                    <f:ajax event="click" render=":form2:productos" />
                                    <f:ajax event="click" render=":form2:productos:cantidad" />
                            
                          
                            <h:graphicImage library="images" name="buscar2.gif" />
                            <p:tooltip id="toolTipFade2" for="buscaXNombre" value="#{msg['app.tooltipBotonBuscarPorNombre']}" />
                        </p:commandLink>
                    
                    </td>
                    <td>             
                    
                        <h:form>
                            <h:panelGrid id="aGestionarMisProductos" columns="2" style="margin-bottom:10px" cellpadding="5">
                          <h:outputText value="#{msg['app.GestionarMisProductos']}:" id="aGestionarMisProductos2"/>
                          <p:selectBooleanCheckbox value="#{productoView.soloMios}">
                               <p:tooltip id="toolTipFade2" for="aGestionarMisProductos" value="#{msg['app.GestionarTusProductos']}" />
                             <f:ajax event="change" render=":form6 @all"/>

                          </p:selectBooleanCheckbox>
                          </h:panelGrid>
                       </h:form>
                    </td>
                </tr>
            </table>
            </h:form>
            
         </div>   
        </p:layoutUnit>
                <!--
                <p:layoutUnit position="south" size="100" closable="true" collapsible="true">
                    Footer
                </p:layoutUnit>
                -->
     
         
                <p:layoutUnit id="izquierda" position="west" size="25%" header="#{productoView.titulo}" collapsible="false"
                              style="background: #e1c1a2 !important;">
                    
            
            <h:form id="form6" style="background-color: #e1c1a2; background: #e1c1a2 !important; width:100%; height: 100%">
             <h:form id="form4" rendered="#{not productoView.soloMios}" style="background-color: #e1c1a2; background: #e1c1a2 !important;">  
               <p:growl id="msgs" showDetail="true" escape="false"/>

                        <p:tree value="#{treeSelectionView.root1}" var="doc"
                                    selectionMode="single"
                                    selection="#{treeSelectionView.selectedNode}"
                                    style="background-color: #e1c1a2">
                            <p:treeNode expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">
                                <h:outputText value="#{doc.nombre}"/>
                            </p:treeNode>
                            <p:treeNode type="document" icon="ui-icon-document">
                                <h:outputText value="#{doc.nombre}" />
                            </p:treeNode>
                            <p:treeNode type="picture" icon="ui-icon-image">
                                <h:outputText value="#{doc.nombre}" />
                            </p:treeNode>
                            <p:treeNode type="mp3" icon="ui-icon-video">
                                <h:outputText value="#{doc.nombre}" />
                            </p:treeNode>
                        </p:tree>
                        
                        <p:commandButton value="#{msg['app.BotonInformaciónCategoría']}" update="msgs" icon="ui-icon-newwin"
                                            actionListener="#{treeSelectionView.displaySelectedSingle}"/>
                        
                        
                        
                          <p:commandButton id="boton2" value="#{msg['app.BotonFiltrarCategoria']}"  update="msgs"  action="#{productoView.buscaXCategoria()}" icon="ui-icon-check" >
                                 
                                  
                                  
                                    <f:ajax event="click" render=":form2:productos" />
                                    <f:ajax event="click" render=":form2:productos:cantidad" />
                                    
                                    </p:commandButton>
    
                </h:form>
                  
                 <h:form id="form5" rendered="#{productoView.soloMios}" style="background-color: #e1c1a2 ; color: #e1c1a2; background: #e1c1a2 !important;">

                    
                  
                     <h:form rendered="#{productoView.filtroMisProductos eq 'ofertados'}" style="background-color: #e1c1a2; background: #e1c1a2 !important;" >
                        <p:growl id="growl"  />
                            <p:separator />
                            <p:commandLink id="subasta" update="growl" actionListener="#{productoView.misOfertadosSubasta}">
                             <f:ajax event="click" render=":form2" />
                            <h:outputText value="#{msg['app.itemSubasta']}" />
                        </p:commandLink>
                               <p:separator />
                        <p:commandLink id="ventaDirecta" actionListener="#{productoView.misOfertadosVentaDirecta}" >
                            <f:ajax event="click" render=":form2" />
                            <h:outputText value="#{msg['app.itemVentaDirecta']}" />
                      
                        </p:commandLink>
                    </h:form>
                     <h:form rendered="#{productoView.filtroMisProductos eq 'comprados'}" style="background-color: #e1c1a2" >
                        <p:growl id="growl"  />
                            <p:separator />
                            <p:commandLink id="subasta" update="growl" actionListener="#{productoView.misProductosCompradosRecibidos()}">
                             <f:ajax event="click" render=":form22" />
                            <h:outputText value="#{msg['app.Recibidos']}" />
                        </p:commandLink>
                               <p:separator />
                               <p:commandLink id="ventaDirecta" update="growl" actionListener="#{productoView.misProductosCompradosNORecibidos()}" >
                            <f:ajax event="click" render=":form22" />
                            <h:outputText value="#{msg['app.NoRecibidos']}" />
                      
                        </p:commandLink>
                    </h:form>
                     <h:form rendered="#{productoView.filtroMisProductos eq 'vendidos'}" style="background-color: #e1c1a2; color: #e1c1a2">
                        <p:growl id="growl" />
                            <p:separator />
                            <p:commandLink id="subasta" update="growl" actionListener="#{productoView.misProductosVendidosEnviados()}">
                             <f:ajax event="click" render=":form22" />
                            <h:outputText value="#{msg['app.Enviados']}" />
                        </p:commandLink>
                               <p:separator />
                               <p:commandLink id="ventaDirecta" actionListener="#{productoView.misProductosVendidosNoEnviados()}" >
                            <f:ajax event="click" render=":form22" />
                            <h:outputText value="#{msg['app.NoEnviados']}" />
                      
                        </p:commandLink>
                    </h:form>                        
                    </h:form>
 
                        <p:separator />
    


               
                </h:form>
               
         </p:layoutUnit>
      

            

     <p:layoutUnit position="center" style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%" >
                  <div class="fondo-centro">  
                <p:growl id="mensajesLayoutCenter" showDetail="true" escape="false"/>                   
                    
                 <h:form id="form1" rendered="false">
                        <p:messages id="msgs1" />
                    <h:panelGrid columns="5" style="margin-bottom:10px" cellpadding="5">
                       
                        <p:growl id="msgs2" showDetail="true" escape="false"/>


                                <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
                                    <p:outputLabel for="vendido" value="vendido:" />
                                    <p:selectOneRadio id="vendido" value="#{productoView.vendidos}">
                                        <f:selectItem itemLabel="Todos" itemValue="todos" />
                                        <f:selectItem itemLabel="solo no vendidos" itemValue="noVendidos" />
                                        <f:selectItem itemLabel="solo ya Vendidos" itemValue="yaVendidos" />
                                    </p:selectOneRadio>
                                </h:panelGrid>
                         <br/>
                 
                         <p:commandButton id="boton0c" value="Aplicar Filtros4455"   action="#{productoView.misOfertadosVentaDirecta()}" icon="ui-icon-check" >
                          <f:ajax event="click" render=":form2" />
                          <f:ajax event="click" render=":form2:productos" />
                          <f:ajax event="click" render=":form2:productos:cantidad" />
                        </p:commandButton>                             
                               

                        

                        
                        
                                 
                                  

                        
                        <h:outputText value=" tipo filtromisproductos: #{productoView.filtroMisProductos}" id="filtroMisPro"/>
                        
                        
                        
                        

                 
                 
                 
                        

                        
                 
                 
                 
                        
                         
                    </h:panelGrid>
                </h:form>
                     
                <h:form id="form2" rendered="#{productoView.filtroMisProductos eq 'ofertados'}" style="background-color: #c8bfe7; background: #e1c1a2 !important; width:100%; height: 100%">

                  <p:growl id="grow21"  showDetail="true" escape="false"/> 
                    <p:poll interval="5" listener="#{productoView.actualizaVistaTodosProductos()}" update="productos" />
                 
                        <p:dataGrid   var="producto" value="#{productoView.listaProductos}" columns="3" 
                            rows="12" paginator="true" id="productos"
                            paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                            rowsPerPageTemplate="6,12,16" 
                            style=" border-color: #c8bfe7; padding: 0px 0px 0px 0px; width: 100%; ; background-color: #c8bfe7; background: #c8bfe7 ">
                            
                            <f:facet name="header">
                                <h:outputText value="#{msg['app.NumeroDeProductos']}: #{productoView.listaProductos.size()}" id="cantidad"/>
                            </f:facet>
                             
                            <p:panel header="#{producto.nombre}" style="text-align:center; border-color: #c8bfe7; padding: 0px 0px 0px 0px; width: 100%; background-color: #c8bfe7; background: #c8bfe7 ">
                                
                                  <div class="fondo-centro">
                             
                                <h:panelGrid columns="1" style="width:100%; background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%">
                   
                                  
                                    
                                  
                                    
                                    <h:graphicImage value="../VisualizaImagen?tipo=imagenUnicaUsuarioIdProducto&amp;idProducto=#{producto.idproducto}" width="50" height="50">
                                   
                                    </h:graphicImage>
                                    
                             
                                    <h:outputText value="idproducto : #{producto.idproducto}" />
                                     <h:outputText rendered="#{not (producto.enSubasta)}" value="___________________" />
                                    <h:outputText value="#{msg['app.Categoria']}: #{producto.categoriaIdcategoria.nombre}" />
                                    
                                    <h:outputText rendered="#{not (producto.enSubasta)}" value="#{msg['app.Precio']} : #{producto.precio}" />
                                    <h:outputText rendered="#{producto.enSubasta}" value="#{msg['app.PrecioDeSalida']}: #{producto.precio}" />
                                    <h:outputText rendered="#{producto.enSubasta}" value="#{msg['app.PujaASuperar']}: #{producto.ultimaPuja}" />
                                    <h:outputText value="#{msg['app.UsuarioOfertador']}: #{producto.usuarioIdusuario.nombre}" />
                                    <h:outputText  rendered="#{not (producto.enSubasta)}" value="#{msg['app.EnVentaDirecta']}" ></h:outputText >
                                    <h:outputText  rendered="#{(producto.enSubasta)}" value="#{msg['app.itemSubasta']}" ></h:outputText >
                                    
                          
                                </h:panelGrid>
                                
                                
                                 <p:commandLink update=":form3:detalleProducto" oncomplete="PF('dialogoProducto').show()" title="#{msg['app.VerDetalles']}">
                                    <h:outputText styleClass="ui-icon ui-icon-search" style="margin:0 auto;" />
                                   <f:setPropertyActionListener value="#{producto}" target="#{productoView.productoSeleccionado}" />
                                </p:commandLink>
                              </div>
                            </p:panel>
                              
                         </p:dataGrid>
                    
                    

                </h:form>
                    
                <h:form id="form22" rendered="#{productoView.filtroMisProductos ne 'ofertados'}" style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%">
                     <p:growl id="grow221"  />
                         
                  
                   <p:poll interval="1" listener="#{productoView.actualizaVistaVentas()}" update="listaVentas" />
                 
                    <p:dataGrid   var="venta" value="#{productoView.listaVentas}" columns="3" 
                            rows="12" paginator="true" id="listaVentas"
                            paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                            rowsPerPageTemplate="6,12,16" 
                            style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%">

                            <f:facet name="header">
                                <h:outputText value=" #{msg['app.NumeroDeProductos']} : #{productoView.listaVentas.size()}" id="cantidadVentas"/>
                            </f:facet>
                            
                        <p:panel  header="#{msg['app.Producto']}: #{venta.productoIdproducto.nombre}" style="text-align:center; background-color: #c8bfe7; background: #c8bfe7 !important">
                                <p:growl id="grow22"  />
                                     <h:outputText value="#{msg['app.FechaDeVenta']}: " />
                                     <h:outputText value="#{venta.fecha}" >
                                       <f:convertDateTime  locale="#{localeBean.locale}"/>
                                    </h:outputText>
                                <h:panelGrid columns="1" style="width:100%">
                   
                                  
                                    
                                  
                                    
                                    <h:graphicImage value="../VisualizaImagen?tipo=imagenUnicaUsuarioVenta&amp;idProducto=#{venta.productoIdproducto.idproducto}" width="50" height="50">
                                   
                                    </h:graphicImage>
                                    
                             
                                    <h:outputText value="#{msg['app.UsuarioComprador']} : #{venta.compradorIdusuario.nombre}    #{venta.compradorIdusuario.apellidos}" />
                                    <h:outputText value="#{msg['app.UsuarioVendedor']} : #{venta.productoIdproducto.usuarioIdusuario.nombre}    #{venta.productoIdproducto.usuarioIdusuario.apellidos}" />
                                 
      
                                    <h:outputText value="#{msg['app.Precio']}: #{venta.precioFinal}" />

                                    <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5" rendered="#{productoView.filtroMisProductos ne 'comprados'}">
                                    <h:outputText value="#{msg['app.EstaEnviado']}: " />
                                    <h:outputText value="#{venta.enviado}" />
                                  
                                    <h:outputText value="#{msg['app.EstaCobrado']}: " />
                                    <h:outputText value="#{venta.cobrado}" />
                                     <h:outputText value="#{msg['app.CompradorMarcadoRecibido']}: " />
                                     <h:outputText value="#{venta.recibido}" />
                                    <h:outputText value="#{msg['app.CompradorMarcadoPagado']}: " />
                                    <h:outputText value="#{venta.pagado}" />                                 
                                    
                                    </h:panelGrid>
                                    
                                    <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5" rendered="#{productoView.filtroMisProductos eq 'comprados'}">
                                    <h:outputText value="#{msg['app.EstaRecibido']}: " />
                                     <h:outputText value="#{venta.recibido}" />
                                    <h:outputText value="#{msg['app.EstaPagado']}: " />
                                    <h:outputText value="#{venta.pagado}" />
                                    <h:outputText value="#{msg['app.VendedorMarcoEnviado']}: " />
                                    <h:outputText value="#{venta.enviado}" />
                                    <h:outputText value="#{msg['app.VendedorMarcoCobrado']}: " />
                                    <h:outputText value="#{venta.cobrado}" />
                                    </h:panelGrid>
                        
                                </h:panelGrid>

                                       <p:separator />
                                <p:commandLink update=":form33:detalleDenuncia" oncomplete="PF('creacionDenuncia').show()" title="#{msg['app.CrearDenuncia']}">
                                    <h:outputText styleClass="ui-icon ui-icon-pin-s" style="margin:0 auto;" />
                                    <h:outputText value ="#{msg['app.Denunciar']}"  />
                                    <f:setPropertyActionListener value="#{venta}" target="#{productoView.ventaSeleccionada}" />
                                </p:commandLink>
                                          <p:separator />
                                <p:commandLink update=":form333:detalleVenta" oncomplete="PF('editarVenta').show()" title="#{msg['app.EditarVentaTitulo']}">
                                    <f:setPropertyActionListener value="#{venta}" target="#{productoView.ventaSeleccionada2}" />
                                    <h:outputText value ="#{msg['app.EditarCompra']}" rendered="#{productoView.filtroMisProductos eq 'comprados'}" />
                                    <h:outputText value ="#{msg['app.EditarVentaTexto']}" rendered="#{productoView.filtroMisProductos ne 'comprados'}" />
                                    
                                </p:commandLink>
                                          <p:separator />
                                      
                            </p:panel>
                         </p:dataGrid>
                    
                    

                </h:form>
                             

                    
                    
                  </div>
                </p:layoutUnit>
                
                
                
                      <h:form id="form3" style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%" >
                          <p:growl id="msgs3" showDetail="true" escape="false"/>
                          <p:messages id="msgsDenduncia" /> 
                             <p:dialog id="dlg" header="#{msg['app.InformacionProducto']}" widgetVar="dialogoProducto" modal="false" showEffect="fade" hideEffect="fade" resizable="true"
                                        width="500" height="550"
                                        style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%">
                                 
                                <p:outputPanel id="detalleProducto" style="text-align:center; background-color: #c8bfe7; background: #c8bfe7 !important;">
                                    
                                    <!--
                                    <p:galleria  value="#{productoView.imagenesProductoSeleccionado}" var="image" panelWidth="500" panelHeight="313" showCaption="false"
                                                            effect="fade" 
                                                            effectSpeed="5000"
                                                 >
                                        <p:graphicImage value="../VisualizaImagen?tipo=porIdImagen&amp;idImagen=#{image.idimagen}"/>
                                    </p:galleria>   
                                    -->
                                    
                                    <p:commandButton type="button" onclick="PF('switcher').previous();"
                                        icon="ui-icon-circle-triangle-w" id="prev"/>
                                    <p:commandButton type="button" onclick="PF('switcher').next();"
                                        icon="ui-icon-circle-triangle-e" id="next"/>

                                    <p:imageSwitch effect="wipe" widgetVar="switcher" id="manuelSwitcher"
                                        slideshowAuto="false">
                                        <ui:repeat value="#{productoView.imagenesProductoSeleccionado}" var="image" id="manuelSwitcherImages">
                                            <p:graphicImage value="../VisualizaImagen?tipo=porIdImagen&amp;idImagen=#{image.idimagen}"/>
                                        </ui:repeat>
                                    </p:imageSwitch>
                                    
                                    
                                    <p:panelGrid  columns="2" rendered="#{not empty productoView.productoSeleccionado and not productoView.soloMios}"  columnClasses="label,value" id="panelDetalle"
                                      style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%"            >
                                    <h:outputText value="#{msg['app.Nombre']}:" />
                                    <h:outputText value="#{productoView.productoSeleccionado.nombre}" />
                                    <h:outputText value="#{msg['app.Descripcion']}:" />
                                    <h:outputText value="#{productoView.productoSeleccionado.descripcion}" />                                    
                                    <h:outputText value="#{msg['app.UsuarioOfertador']}" />
                                    <h:outputText value="#{productoView.productoSeleccionado.usuarioIdusuario.nombre}" />
                                    <h:outputText value="#{msg['app.EmailUsuario']}" />
                                    <h:outputText value="#{productoView.productoSeleccionado.usuarioIdusuario.email}" />                                    
                                    <h:outputText value="#{msg['app.FechaDePuestaEnVenta']}:" />                                   
                                    <h:outputText value="#{productoView.productoSeleccionado.fechaProducto}" >
                                        <f:convertDateTime locale="#{localeBean.locale}" />
                                        <!--
                                     <f:convertDateTime pattern="d-M-yyyy" locale="#{productoView.locale}" />
                                     -->
                                    </h:outputText>
                                    <h:outputText  rendered="#{not (productoView.productoSeleccionado.enSubasta)}" value="#{msg['app.Precio']}:" ></h:outputText >
                                    <h:outputText  rendered="#{not (productoView.productoSeleccionado.enSubasta)}" value="#{productoView.productoSeleccionado.precio}" ></h:outputText >
                                    <h:outputText  rendered="#{(productoView.productoSeleccionado.enSubasta)}" value="#{msg['app.PujaASuperar']}:" ></h:outputText >
                                    <h:outputText  rendered="#{(productoView.productoSeleccionado.enSubasta)}" value="#{(productoView.productoSeleccionado.ultimaPuja)}" ></h:outputText >
                                 
                                  
                                  
                                  </p:panelGrid>
                                    

                                    <p:panelGrid  columns="2" rendered="#{not empty productoView.productoSeleccionado and  productoView.soloMios and productoView.productoSeleccionado.enSubasta and not productoView.productoSeleccionado.expirado }"  columnClasses="label,value" id="panelDetalle2"
                                    style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%" >
                                                                      

                                    <h:outputText value="#{msg['app.Nombre']}:" />
                                    <h:inputText value="#{productoView.productoSeleccionado.nombre}" />
                                    <h:outputText value="#{msg['app.Descripcion']}: " />
                                    <h:inputText value="#{productoView.productoSeleccionado.descripcion}" />
                                    <h:outputText value="#{msg['app.PrecioDeSalida']}: " />
                                    <h:inputText value="#{productoView.productoSeleccionado.precio}"/>
                                    <h:outputText   value="#{msg['app.UltimaPuja']}:" ></h:outputText >
                                    <h:outputText  value="#{(productoView.productoSeleccionado.ultimaPuja)}"/>                                   
                                    
                                    
                                  </p:panelGrid>
                                    
                                    <p:commandButton rendered="#{(productoView.productoSeleccionado.enSubasta)and (not productoView.productoSeleccionado.expirado)and productoView.soloMios}" id="botonSalvarSubasta" value="Salvar Producto" update=":form2:grow21 :form2"    actionListener="#{productoView.salvarProducto()}" 
                                                     icon="ui-icon-check" oncomplete="PF('dialogoProducto').hide();" >
  
                                               
                                                 <f:param id="parametro112" name="idProductoASalvar" value="#{productoView.productoSeleccionado.idproducto}" />

                                                                                <p:confirm header="#{msg['app.Confirmacion']}" message="#{msg['app.ConfirmacionCambiarProducto']}" icon="ui-icon-alert" />
                                        </p:commandButton>
                                        
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                            <p:commandButton value="#{msg['app.Si']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="#{msg['app.No']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </p:confirmDialog>                                    
                                    
                                    
                                    
                                    
                                    
                                    <p:panelGrid  columns="2" rendered="#{not empty productoView.productoSeleccionado and  productoView.soloMios and not productoView.productoSeleccionado.enSubasta}"  columnClasses="label,value" id="panelDetalle21"
                                    style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%" >
                                         
                                    <h:outputText value="#{msg['app.Nombre']}:" />
                                    <h:inputText value="#{productoView.productoSeleccionado.nombre}" />
                                    <h:outputText value="#{msg['app.Descripcion']}:" />
                                    <h:inputText value="#{productoView.productoSeleccionado.descripcion}" />
                                    <h:outputText   value="#{msg['app.Precio']}:" ></h:outputText >
                                    <h:inputText  value="#{productoView.productoSeleccionado.precio}" ></h:inputText >
                                                                       
                                  </p:panelGrid>  
                                    

                                    <p:commandButton rendered="#{not(productoView.productoSeleccionado.enSubasta)and not productoView.productoSeleccionado.vendido and productoView.soloMios}" id="botonSalvarVentaDirecta" value="#{msg['app.SalvarProducto']}" update=":form2:grow21 :form2"    actionListener="#{productoView.salvarProducto()}" 
                                                     icon="ui-icon-check" oncomplete="PF('dialogoProducto').hide();" >
  
                                               
                                                 <f:param id="parametro111" name="idProductoASalvar" value="#{productoView.productoSeleccionado.idproducto}" />

                                     <p:confirm header="#{msg['app.Confirmacion']}" message="#{msg['app.ConfirmacionCambiarProducto']}" icon="ui-icon-alert" />
                                    </p:commandButton>
                                        
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                            <p:commandButton value="#{msg['app.Si']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="#{msg['app.No']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </p:confirmDialog>  
                               
                                    <p:commandButton rendered="#{not (productoView.productoSeleccionado.enSubasta)and (not productoView.productoSeleccionado.vendido )and not productoView.soloMios}" id="boton" value="#{msg['app.BotonComprarProducto']}" update="msgs3 :form2:grow21 :form2"    actionListener="#{gestionProductoBean.compraProducto()}" icon="ui-icon-check"
                                                     oncomplete="PF('dialogoProducto').hide();">
  
                                                 <f:param id="parametro1" name="idUsuarioComprador" value="#{sessionScope.usuario.idusuario}" />
                                                 <f:param id="parametro2" name="idProductoAComprar" value="#{productoView.productoSeleccionado.idproducto}" />

                                                <p:confirm header="#{msg['app.Confirmacion']}" message="#{msg['app.ConfirmacionCompra']}" icon="ui-icon-alert" />
                                    </p:commandButton>
                                        
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                            <p:commandButton value="#{msg['app.Si']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="#{msg['app.No']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </p:confirmDialog> 
                                    
                                    
                                    
                                    
                                    
                                    
                                    <p:commandButton rendered="#{productoView.soloMios}" id="botonBorrar" value="#{msg['app.BotonBorrarProducto']}" update=":form2:grow21 :form2"    actionListener="#{productoView.borrarProductoNoVendido()}" 
                                                     icon="ui-icon-check" oncomplete="PF('dialogoProducto').hide();" >
  
                                               
                                                 <f:param id="parametroBorrar111" name="idProductoABorrar" value="#{productoView.productoSeleccionado.idproducto}" />

                                     <p:confirm header="#{msg['app.Confirmacion']}" message="#{msg['app.ConfirmacionBorrarProducto']}" icon="ui-icon-alert" />
                                    </p:commandButton>
                                        
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                            <p:commandButton value="#{msg['app.Si']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="#{msg['app.No']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </p:confirmDialog>                                      
                                    
                                    <h:outputText rendered="#{not (productoView.productoSeleccionado.enSubasta)and (productoView.productoSeleccionado.vendido )}" value="#{msg['app.ProductoVendido']}"  style="color: red" />
                                    
                                    <p:inputText rendered="#{(productoView.productoSeleccionado.enSubasta)and not productoView.productoSeleccionado.expirado and not productoView.soloMios}" id="puja" value="#{gestionProductoBean.pujaPropuesta}" label="puja">
                                        <f:validateLength minimum="1" />
                                    </p:inputText>
                                    
                                    <p:commandButton rendered="#{(productoView.productoSeleccionado.enSubasta)and not productoView.productoSeleccionado.expirado and not productoView.soloMios}" id="boton2" value="#{msg['app.RealizarPuja']}"  actionListener="#{gestionProductoBean.pujaXProducto()}" icon="ui-icon-check" update=":form2 msgs3 " 
                                                         >
  
                                                 <f:param id="parametro3" name="idUsuarioComprador" value="#{sessionScope.usuario.idusuario}" />
                                                 <f:param id="parametro4" name="idProductoAComprar" value="#{productoView.productoSeleccionado.idproducto}" />
                                                 <f:ajax event="click" render=":form3:detalleProducto" />
                                                 <f:ajax event="click" render=":form2:productos" />
                                                 
                                    </p:commandButton>
                                    
                                    <h:outputText value="&lt;br/&gt;" escape="false" />
                                    <h:outputText rendered="#{(productoView.productoSeleccionado.enSubasta) and not productoView.productoSeleccionado.expirado and not productoView.soloMios}" 
                                                  value="#{msg['app.PodraPujarDurante']}" />
                                    <h:outputText value="&lt;br/&gt;" escape="false" />
                                     <h:outputText rendered="#{(productoView.productoSeleccionado.enSubasta) and not productoView.productoSeleccionado.expirado and not productoView.soloMios}" 
                                                  value="#{productoView.elapsedDays} #{msg['app.Dias']}  #{productoView.elapsedHours} #{msg['app.Horas']} #{productoView.elapsedMinutes} #{msg['app.MinutosY']} #{productoView.elapsedSeconds} #{msg['app.Segundos']} " />
                                                                    
                                      <h:outputText rendered="#{(productoView.productoSeleccionado.enSubasta) and (productoView.productoSeleccionado.expirado)}" value="#{msg['app.ExpiradoTiempoDePuja']}"  style="color: red" />
                                       <BR/>
                                      <p:commandButton id="botonDenunciaMalClasificado" value="#{msg['app.BotonMalClasificado']}"   actionListener="#{productoView.creaDenunciaMalClasificado()}" 
                                                         icon="ui-icon-check" update=":form2 msgs3" >
                                            <p:confirm header="#{msg['app.Confirmacion']}" message="#{msg['app.ConfirmacionMalClasificado']}"  icon="ui-icon-alert" />
                                            <f:param id="parametroProductoMalClasificado" name="idProductoMalClasificado" value="#{productoView.productoSeleccionado.idproducto}" />
                                        </p:commandButton>
                                        
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                            <p:commandButton value="#{msg['app.Si']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="#{msg['app.No']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </p:confirmDialog>    
                                       
                                       
                                       <BR/>
        <h:outputLink value="https://twitter.com/intent/tweet" target="_blank" id="botonTwitter" >
           
            <h:graphicImage library="images" name="twitter.png" width="30" height="30"/>
            
            <f:param name="url" value="http://www.buyup.com"/>
            <f:param name="text" value="#{msg['app.MiraElProducto']} #{productoView.productoSeleccionado.nombre}  #{msg['app.AlaVentaPor']} #{productoView.productoSeleccionado.precio} #{msg['app.En']} "/>
	
	    <p:tooltip id="toolTipFadeTwitter" for="botonTwitter" value="#{msg['app.Twittear']}"/>
        </h:outputLink>

        <h:outputLink value="http://www.facebook.com/sharer.php" target="_blank" id="botonFaceBook" >
           
            <h:graphicImage library="images" name="facebook.ico" width="30" height="30"/>
             <f:param name="u" value="" />
                <f:param name="t" value="#{msg['app.ProductoEn']}" />
      	    <p:tooltip id="toolTipFadeFaceBook" for="botonFaceBook" value="#{msg['app.Facebook']}"/>
        </h:outputLink>

        <h:outputLink value="http://www.tuenti.com/share" target="_blank" id="botonTuenti" >
           
            <h:graphicImage library="images" name="tuenti.png" width="30" height="30"/>
             <f:param name="url" value="http://www.buyup.com" />
      
      	    <p:tooltip id="toolTipTuenti" for="botonTuenti" value="#{msg['app.Tuenti']}"/>
        </h:outputLink>

                                </p:outputPanel>
                            </p:dialog>
                    
                       </h:form>
                       <h:form id="form33" style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%">
                          
                             <p:dialog id="dlg" header="#{msg['app.CrearDenuncia']}" widgetVar="creacionDenuncia" 
                                        width="500" height="350"
                                        style="background-color: #c8bfe7; background: #c8bfe7;">
                                 
                                 
                                <p:outputPanel id="detalleDenuncia" style="text-align:center; background-color: #c8bfe7; background: #c8bfe7;">
                                    <p:growl id="growlDenuncia" showDetail="true" sticky="true" /> 
                                    <p:messages id="msgsDenduncia" /> 
                                    
                                   
                                   
                                    <p:separator />
                                    
                                    <h:outputText value="#{msg['app.InfoCrearDenuncia']}: #{productoView.ventaSeleccionada.productoIdproducto.nombre}  " />
                                    <p:separator />
                                    
                                   
                                <h:panelGrid columns="4" cellpadding="2">         
            
                                    <h:outputLabel for="motivoDenuncia" value="#{msg['app.MotivoDenuncia']}: " />
                                    <p:inputTextarea rows="5" cols="30" counter="display" maxlength="300"  counterTemplate="{0} #{msg['app.CaracteresRestantes']}." autoResize="false" 
                                                     id="motivoDenuncia" value="#{productoView.motivoDenuncia}" label="motivoDenuncia">   
                                      <f:validateLength minimum="5" />
                                    </p:inputTextarea>
                                         <h:outputText id="display" />
                                    <p:message for="motivoDenuncia" /> 
                                </h:panelGrid> 

                                    <p:separator />
                                    
                                    <!--
                                    <h:outputLabel for="tipoDenuncia" value="#{msg['app.DenunciarFaltaEnvio']} " rendered="#{productoView.filtroMisProductos eq 'comprados'}" />
                                    <h:outputLabel for="tipoDenuncia2" value="#{msg['app.DenunciarFaltaPago']} " rendered="#{productoView.filtroMisProductos ne 'comprados'}"/>
                                    -->
                                    
                                    <h:selectOneMenu id="questionStatus" value="#{productoView.tipoDenuncia}" rendered="#{productoView.filtroMisProductos ne 'comprados'}" >
                                        <f:selectItem itemLabel="#{msg['app.NO_PAGADO']}" itemValue="NO_PAGADO" rendered="#{productoView.filtroMisProductos ne 'comprados'}" />
                                  <!--     <f:selectItem itemLabel="NO_ENVIADO" itemValue="NO_ENVIADO" rendered="#{productoView.filtroMisProductos eq 'comprados'}"/> -->

                                    </h:selectOneMenu>
                                    
                                                                        
                                    <h:selectOneMenu id="questionStatus2" value="#{productoView.tipoDenuncia}" rendered="#{productoView.filtroMisProductos eq 'comprados'}" >
                                     <!--   <f:selectItem itemLabel="NO_PAGADO" itemValue="NO_PAGADO" rendered="#{productoView.filtroMisProductos ne 'comprados'}" /> -->
                                        <f:selectItem itemLabel="#{msg['app.NO_ENVIADO']}" itemValue="NO_ENVIADO" rendered="#{productoView.filtroMisProductos eq 'comprados'}"/>

                                    </h:selectOneMenu>
                                    
                                    <p:separator />
                                        <p:growl id="msgs33" showDetail="true" escape="false"/>
                                        
                                        <p:commandButton id="botonDenuncia" value="#{msg['app.BotonDenunciarVenta']}" update=":form22:grow221"    actionListener="#{productoView.creaDenuncia()}" 
                                                         icon="ui-icon-check" oncomplete="PF('creacionDenuncia').hide();" >
                                            <p:confirm header="#{msg['app.Confirmacion']}" message="#{msg['app.ConfirmacionDenunciarVenta']}" icon="ui-icon-alert" />
                                        </p:commandButton>
                                        
                                        <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                            <p:commandButton value="#{msg['app.Si']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                            <p:commandButton value="#{msg['app.No']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                        </p:confirmDialog>
                                        
                                        
                                        
 
                                 
                                </p:outputPanel>
                              
                            </p:dialog>
                           
                           
                            
                    
                       </h:form>                
                       
                          
    
                          <h:form id="form333" style="background-color: #c8bfe7; background: #c8bfe7 !important; width:100%; height: 100%"> 
                           
                             <p:dialog id="dialogoEditarVenta" header="#{msg['app.DetallesVenta']}" widgetVar="editarVenta" 
                                        width="500" height="350"
                                        style="background-color: #c8bfe7; background: #c8bfe7;">
                                
                                 
                                <p:outputPanel id="detalleVenta" style="text-align:center; background-color: #c8bfe7; background: #c8bfe7;">
                                    
                                    <h:graphicImage value="../VisualizaImagen?tipo=imagenUnicaVentaSeleccionada&amp;idProducto=#{productoView.ventaSeleccionada2.productoIdproducto.idproducto}" width="50" height="50" style="alignment-adjust: central">
                                   
                                    </h:graphicImage>

                                    
                                    
                                   <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5" rendered="#{productoView.filtroMisProductos ne 'comprados'}">
                                    <h:outputText value="#{msg['app.EstaEnviado']}: " />
                                    <p:selectBooleanButton id="value1" value="#{productoView.ventaSeleccionada2.enviado}" onLabel="#{msg['app.Si']}" offLabel="#{msg['app.No']}" style="width:60px" />
                                  
                                    <h:outputText value="#{msg['app.EstaCobrado']}: " />
                                    <p:selectBooleanButton id="value4" value="#{productoView.ventaSeleccionada2.cobrado}" onLabel="#{msg['app.Si']}" offLabel="#{msg['app.No']}" style="width:60px" />
                                     <h:outputText value="#{msg['app.CompradorMarcadoRecibido']}: " />
                                     <h:outputText value="#{productoView.ventaSeleccionada2.recibido}" />
                                    <h:outputText value="#{msg['app.CompradorMarcadoPagado']}: " />
                                    <h:outputText value="#{productoView.ventaSeleccionada2.pagado}" />                                 
                                    
                                    </h:panelGrid>
                                    
                                    <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5" rendered="#{productoView.filtroMisProductos eq 'comprados'}">
                                    <h:outputText value="#{msg['app.EstaRecibido']}: " />
                                    <p:selectBooleanButton id="value2" value="#{productoView.ventaSeleccionada2.recibido}" onLabel="#{msg['app.Si']}" offLabel="#{msg['app.No']}" style="width:60px" />
                                    <h:outputText value="#{msg['app.EstaPagado']}: " />
                                    <p:selectBooleanButton id="value3" value="#{productoView.ventaSeleccionada2.pagado}" onLabel="#{msg['app.Si']}" offLabel="#{msg['app.No']}" style="width:60px" />
                                    <h:outputText value="#{msg['app.VendedorMarcoEnviado']}: " />
                                    <h:outputText value="#{productoView.ventaSeleccionada2.enviado}" />
                                    <h:outputText value="#{msg['app.VendedorMarcoCobrado']}: " />
                                    <h:outputText value="#{productoView.ventaSeleccionada2.cobrado}" />
                                    </h:panelGrid>
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    

                                    <p:separator />
                                        

                                        
                                        <p:commandButton id="botonActualizaVenta" value="#{msg['app.BotonGuardarVenta']}" update=":form22:grow221"    actionListener="#{productoView.salvaVenta()}" 
                                                         icon="ui-icon-check" oncomplete="PF('editarVenta').hide();" >
                                             <f:ajax event="dialogReturn" render=":form22 @all" />
                                        
                                         
                                        </p:commandButton>
                                        <p:separator />
                                        <p:commandButton  rendered="#{productoView.filtroMisProductos eq 'vendidos'}" id="botonBorrarVenta2" value="#{msg['app.BotonBorrarVenta']}" update=":form22:grow221"    actionListener="#{productoView.borrarVenta()}" 
                                                     icon="ui-icon-check"  oncomplete="PF('editarVenta').hide();" >
  
                                               
                                                <f:ajax event="dialogReturn" render=":form22" />
                                                 <f:ajax event="dialogReturn" render=":form22:grow221" />
                                            <f:param id="parametro222" name="idVentaABorrar" value="#{productoView.ventaSeleccionada2.idventa}" />

                                        </p:commandButton>
                                        
    
                                        

                                        
                                        
 
                                 
                                </p:outputPanel>
                              
                            </p:dialog>
                    </h:form>
                                     
                

            </p:layout>
            <h:outputText value="#{msg['app.NoEstasRegistradoComoSocioParaPoderAccederAEstaPagina']}"    rendered="#{ROLE_ADMIN}" />
            <BR/>
             <h:link outcome="/admin/index" value="#{msg['app.Volver']}"   rendered="#{ROLE_ADMIN}" />
            <h:outputText value="#{msg['app.NoEstasLogadoParaPoderAccederAEstaPagina']}"    rendered="#{!ROLE_SOCIO and !ROLE_ADMIN}" />
            <BR/>
            <h:link outcome="/faces/index" value="#{msg['app.Volver']}" rendered="#{!ROLE_SOCIO and !ROLE_ADMIN}" />

        </h:body>

    </f:view>
</html>
